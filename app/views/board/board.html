<div id="board-container">
	<div class="row">
		<div class="col s12 right-align">
			<button class="btn" ng-click="openTaskCreator()">
				<i class="fa fa-plus"></i>
				New task
			</button>
			<a class="btn" ui-sref="boardSettings({boardId: board.id})"
				ng-if="board.isLoggedUserBoardAdmin">
				<i class="fa fa-cog"></i>
				Settings
			</a>
		</div>
	</div>

	<div id="board-table-wrapper" class="center-align">
		<table id="table" class="z-depth-1">
			<thead>
			<tr>
				<th ng-repeat="column in columns track by column.id">
					{{column.name}}
					<small>
						[{{column.tasks.length}}<!--
					--><span ng-if="column.workInProgressLimit > 0">
						/ {{column.workInProgressLimit}}<!--
					--></span>]
					</small>
				</th>
			</tr>
			</thead>
			<tbody>
			<tr>
				<td ng-repeat="column in columns track by column.id"
					as-sortable="dragListeners"
					ng-model="column.tasks">
					<div class="task"
						 ng-repeat="task in column.tasks"
						 ng-click="openTaskDetails(task)"
						 as-sortable-item>
						<div as-sortable-item-handle>
							<header board-label="{{::labels[task.labelId].color}}">
								#{{::task.idOnBoard}}
							</header>
							<section>
								{{::task.title | characters:70}}
							</section>
							<footer>
								<span ng-switch="::task.priority">
									<i ng-switch-when="LOW"
									   class="fa fa-circle green-text"
									   data-tooltip="Low priority"
									   tooltipped></i>
									<i ng-switch-when="MEDIUM"
									   class="fa fa-exclamation orange-text"
									   data-tooltip="Medium priority"
									   tooltipped></i>
									<i ng-switch-when="HIGH"
									   class="fa fa-exclamation-triangle red-text"
									   data-tooltip="High priority"
									   tooltipped></i>
								</span>
								<i class="fa fa-user"
								   data-tooltip="Assigned to {{::members[task.assigneeId].username}}"
								   ng-if="::task.assigneeId"
								   tooltipped></i>
								<i class="fa fa-align-left grey-text text-lighten-1"
								   data-tooltip="Task has a description"
								   ng-if="::task.description"
								   tooltipped></i>

								<span class="right">
									<a href=""
									   data-activates='board-task-options-{{::task.id}}'
									   data-alignment="right"
									   data-constrainwidth="false"
									   ng-click="$event.stopPropagation()"
									   dropdown>
										<i class="fa fa-ellipsis-v grey-text clickable"
										   data-tooltip="Options"
										   tooltipped></i>
									</a>

									<ul id='board-task-options-{{::task.id}}' class='dropdown-content'>
										<li>
											<a href="" ng-click="deleteTask(task); $event.stopPropagation()">
												delete
											</a>
										</li>
									</ul>
								</span>
							</footer>
						</div>
					</div>
				</td>
			</tr>
			</tbody>
		</table>
	</div>
</div>

